(window.webpackJsonpbbb=window.webpackJsonpbbb||[]).push([[5],{528:function(t,e,a){"use strict";a.r(e),a.d(e,"default",(function(){return S}));var n=a(16),r=a(17),o=a(20),i=a(18),s=a(19),l=a(0),c=a.n(l),m=(a(54),a(479)),u=a.n(m),d=a(315),h=a(448),p=window.location.protocol+"//"+window.location.host+"/api",f=p+"/today",g=p+"/today2",y=p+"/controls",v=p+"/roomssensors",k=p+"/settings",S=function(t){function e(){var t;return Object(n.a)(this,e),(t=Object(o.a)(this,Object(i.a)(e).call(this)))._isMounted=!1,t.updateSec=function(){t.setState({time:new Date})},t.makeChartJson=function(t,e,a){return{id:e,color:a,data:t.filter((function(t){return null!==t})).map((function(t,e){return{x:e<9?"0".concat(e+1):"".concat(e+1),y:t}}))}},t.makeChartNowJson=function(e,a){return{what:t.state.currency,max:t.state.max,maxColor:"hsl(15, 100%, 34%)",min:t.state.min,minColor:"hsl(38, 79%, 56%)",nu:parseFloat(a)/10,nuColor:"hsl(54, 84%, 65%)",medel:parseFloat(e)/10,medelColor:"hsl(96, 32%, 40%)"}},t.makeChartTempJson=function(){var e=t.state.tempis>t.state.should?"hsl(15, 100%, 34%)":"hsl(194, 37%, 57%)";return{what:"Uppm\xe4tt: "+t.state.measured,"\xf6nskad":t.state.should,"\xf6nskadColor":"hsl(96, 32%, 40%)",verklig:parseFloat(t.state.tempis),verkligColor:e}},t.myformatter=function(t){var e=(parseFloat(t)/10).toFixed(1);return e=(e=e.toString()).replace(".",","),""===t&&(e=null),e},t.extractPrices=function(e){for(var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=[],r=["N\xe4r"],o=t.state.max,i=t.state.min,s=1;s<25;s++){var l="Hour"+s,c=s<10?"0"+s:s+"",m=0;3===s&&((m=""===e[l="Hour"+s+"A"]?null:parseFloat(e[l])/10)&&(i=m<i&&null===a?m:i,o=m>o&&null===a?m:o,m=m.toFixed(1),n.push(m),r.push(c)),l="Hour"+s+"B",c="VT"),(m=""===e[l]?null:parseFloat(e[l])/10)&&(i=m<i&&null===a?m:i,o=m>o&&null===a?m:o,m=m.toFixed(1),n.push(m),r.push(c))}return t.setState({hours:r}),t.setState({max:o}),t.setState({min:i}),n},t.handlePrices=function(t){for(var e=[],a=0;a<t.length;a++){var n=null===t[a]?t[a]:t[a].toString();n=null===n?n:n.replace(".",","),e.push(n)}return e},t.MyResponsiveBar=function(e){var a=c.a.createElement(h.a,{data:e,keys:["max","min","nu","medel"],margin:{top:50,right:50,bottom:50,left:60},padding:.1,innerPadding:15,indexBy:"what",groupMode:"grouped",colors:function(t){var e=t.id;return t.data["".concat(e,"Color")]},borderRadius:5,borderColor:{from:"color",modifiers:[["darker",2]]},axisTop:null,axisRight:null,axisBottom:{tickSize:5,tickPadding:5,tickRotation:0,legend:"",legendOffset:36},axisLeft:{tickSize:5,tickPadding:5,tickRotation:0,legend:"Idag",legendPosition:"start",legendOffset:-40},labelSkipWidth:20,labelSkipHeight:20,labelTextColor:"black",label:function(t){return"".concat(t.value)},enableGridY:!0,legends:[{dataFrom:"keys",anchor:"top-left",direction:"row",justify:!1,translateX:10,translateY:-20,itemsSpacing:5,itemWidth:50,itemHeight:10,itemDirection:"left-to-right",itemOpacity:.9,symbolSize:10,effects:[{on:"hover",style:{itemOpacity:1}}]}],tooltip:function(e){var a=e.id,n=e.value,r=e.color;return c.a.createElement("strong",{style:{color:r}},a,": ",n," ",t.state.currency)},theme:{tooltip:{container:{background:"#474747"}}},animate:!0,motionStiffness:90,motionDamping:15});t.setState({chartnow:a})},t.MyResponsiveTempBar=function(e){var a=c.a.createElement(h.a,{data:e,keys:["verklig","\xf6nskad"],margin:{top:50,right:40,bottom:50,left:40},padding:0,innerPadding:10,indexBy:"what",groupMode:"grouped",barComponent:function(e){var a=e.x,n=e.y,r=e.width,o=e.height,i=e.color,s=e.data;return c.a.createElement(c.a.Fragment,null,c.a.createElement("circle",{cx:a+r/2,cy:n+o/2,r:Math.min(r,o)/2,fill:i}),c.a.createElement("text",{x:a+r/2,y:n+o/2-o/6,alignmentBaseline:"central",textAnchor:"middle",stroke:"#f8f9fa",dy:".1em",strokeWidth:"1px"},t.state.name,c.a.createElement("tspan",{x:a+r/2,y:n+o/2+o/6},s.value," ","\xb0C")))},colors:function(t){var e=t.id;return t.data["".concat(e,"Color")]},borderRadius:5,borderColor:{from:"color",modifiers:[["darker",2]]},axisTop:null,axisRight:null,axisLeft:null,axisBottom:{tickSize:0,legend:""},labelSkipWidth:20,labelSkipHeight:20,labelTextColor:"black",label:function(e){return t.state.name+": ".concat(e.value)+"\xb0C"},enableGridY:!0,legends:[{dataFrom:"keys",anchor:"top-left",direction:"row",justify:!1,translateX:10,translateY:-20,itemsSpacing:5,itemWidth:50,itemHeight:20,itemDirection:"left-to-right",itemOpacity:.9,symbolSize:10,effects:[{on:"hover",style:{itemOpacity:1}}]}],animate:!0,motionStiffness:90,motionDamping:15});t.setState({charttemp:a})},t.MyResponsiveLine=function(e){var a=c.a.createElement(d.a,{data:e,margin:{top:50,right:5,bottom:50,left:35},xScale:{type:"point"},yScale:{type:"linear",min:0,max:"auto"},axisTop:null,axisRight:null,axisBottom:{tickSize:3,tickPadding:3,tickRotation:0,legend:"Spotpriser",legendOffset:35,legendPosition:"start"},axisLeft:{orient:"left",tickSize:3,tickPadding:3,tickRotation:0,legend:t.state.currency,legendOffset:-30,legendPosition:"end"},colors:{datum:"color"},pointSize:5,pointColor:{from:"color",modifiers:[]},pointBorderWidth:2,pointBorderColor:{from:"color"},pointLabel:"y",pointLabelYOffset:60,enableSlices:"x",legends:[{anchor:"top-left",direction:"row",justify:!1,translateX:10,translateY:-40,itemsSpacing:0,itemDirection:"left-to-right",itemWidth:80,itemHeight:20,itemOpacity:.9,symbolSize:10,symbolShape:"circle",symbolBorderColor:"rgba(0, 0, 0, .9)",effects:[{on:"hover",style:{itemBackground:"rgba(0, 0, 0, .08)",itemOpacity:1}}]}]});t.setState({chart:a})},t.state={pricenow:"0",currency:"\xf6re/kwh",hour:"0",name:"",average:"0",tempis:"0",measured:"0",should:"0",percent:"0",max:0,min:3e3,today:"",tomorrow:"",hours:[],prices:[],controls:[],tomspot:[],chart:null,chartdata:null,chartnow:null,chartnowdata:null,charttemp:null,charttempdata:null,time:new Date},t}return Object(s.a)(e,t),Object(r.a)(e,[{key:"componentDidMount",value:function(){var t=this;this._isMounted=!0;var e=this.state.time,a=e.getHours(),n=e.getDate(),r=e.getDate()+1,o=e.getMonth()+1,i=n+"/"+o,s=r+"/"+o;e.getMinutes();a=0===a?24:a,fetch(v).then((function(t){return t.json()})).then((function(e){if(t._isMounted){console.log("roomssensors",e[0]);var a=e&&e[0]&&e[0].tempis?e[0].tempis.toFixed(1):"",n=a||"Kommer visa \xe4rv\xe4rde";return t.setState({tempis:n}),e[0]&&(t.setState({measured:e[0].measured}),t.setState({should:e[0].should}),t.setState({name:e[0].roomname})),fetch(f)}})).then((function(t){return t.json()})).then((function(e){if(t._isMounted){var n="Hour"+a,r="EUR"===e.Currency?"c/kwh":"\xf6re/kwh",o=t.myformatter(e.Average),l=t.myformatter(e[n]),c=t.extractPrices(e),m=t.handlePrices(c),u=t.makeChartJson(c,"idag","hsl(15, 100%, 34%)"),d=t.makeChartNowJson(e.Average,e[n]),h=t.makeChartTempJson();return t.setState({average:o}),t.setState({pricenow:l}),t.setState({hour:a}),t.setState({currency:r}),t.setState({today:i}),t.setState({tomorrow:s}),t.setState({prices:m}),t.setState({chartdata:u}),t.setState({chartnowdata:d}),t.setState({charttempdata:h}),t.MyResponsiveLine([t.state.chartdata]),t.MyResponsiveBar([t.state.chartnowdata]),t.MyResponsiveTempBar([t.state.charttempdata]),fetch(y)}})).then((function(t){return t.json()})).then((function(e){return console.log("data2",e),t.setState({controls:e}),a>=16?fetch(g).then((function(t){return t.json()})).then((function(e){var a=t.extractPrices(e,"tomorrow"),n=t.handlePrices(a),r=t.state.chartdata,o=t.makeChartJson(a,"imorgon","hsl(194, 38%, 30%)"),i=[];return r&&i.push(r),o&&i.push(o),t.setState({tomspot:n}),t.MyResponsiveLine(i),fetch(k)})):fetch(k)})).then((function(t){return t.json()})).then((function(e){t.setState({percent:e.percent})})).catch((function(t){if(console.log(t),"AbortError"!==t.name)throw t})),setInterval(this.updateSec,1e3)}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"render",value:function(){var t=this.state.prices,e=this.state.controls,a=this.state.hours,n=this.state.percent,r=null,o=null,i=this.state.time,s=i.getHours(),l=i.getMinutes(),m=i.getSeconds();return this.state.hour>=16&&(r=c.a.createElement("td",null,this.state.tomorrow),o=this.state.tomspot.map((function(t,e){return c.a.createElement("td",{key:e},t)}))),c.a.createElement("div",{className:"hub-page"},c.a.createElement("h1",null,"V\xe4lkommen till BehovsBoBoxen 2019"),c.a.createElement("p",null,s,":",l<10?"0"+l:l,":",m<10?"0"+m:m),c.a.createElement("div",{className:"half"},c.a.createElement("div",{className:"chartnow"},this.state.chartnow)),c.a.createElement("div",{className:"half"},c.a.createElement("div",{className:"charttemp"},this.state.charttemp)),c.a.createElement(u.a,{striped:!0,bordered:!0,hover:!0,size:"sm",responsive:!0,className:"mytable"},c.a.createElement("thead",null,c.a.createElement("tr",null,a.map((function(t,e){return c.a.createElement("th",{key:e},t)})))),c.a.createElement("tbody",null,c.a.createElement("tr",null,c.a.createElement("td",null,this.state.today),t.map((function(t,e){return c.a.createElement("td",{key:e},t)}))),c.a.createElement("tr",{className:"control"},c.a.createElement("td",null,n+"%"),e.map((function(t,e){return c.a.createElement("td",{key:e,className:"class"+t})}))),c.a.createElement("tr",null,r,o))),c.a.createElement("div",{className:"chart"},this.state.chart))}}]),e}(l.Component)}}]);
//# sourceMappingURL=5.7594daa1.chunk.js.map