(window.webpackJsonpbbb=window.webpackJsonpbbb||[]).push([[5],{493:function(t,e,a){"use strict";a.r(e),a.d(e,"default",(function(){return S}));var n=a(16),r=a(17),o=a(21),s=a(18),l=a(20),i=a(0),c=a.n(i),u=(a(69),a(444)),m=a.n(u),h=a(290),p="http://"+window.location.hostname+":1337",d=p+"/today",f=p+"/spotcal/2",g=p+"/controls",y=p+"/zones/1",b=p+"/settings",S=function(t){function e(){var t;return Object(n.a)(this,e),(t=Object(o.a)(this,Object(s.a)(e).call(this)))._isMounted=!1,t.updateSec=function(){t.setState({time:new Date})},t.makeChartJson=function(t,e,a){return{id:e,color:a,data:t.filter((function(t){return null!==t})).map((function(t,e){return{x:e<9?"0".concat(e+1):"".concat(e+1),y:t}}))}},t.myformatter=function(t){var e=(parseFloat(t)/10).toFixed(1);return e=(e=e.toString()).replace(".",","),""===t&&(e=null),e},t.extractPrices=function(e){for(var a=[],n=["N\xe4r"],r=1;r<25;r++){var o="Hour"+r,s=r<10?"0"+r:r+"",l=0;3===r&&((l=""===e[o="Hour"+r+"A"]?null:(parseFloat(e[o])/10).toFixed(1))&&(a.push(l),n.push(s)),o="Hour"+r+"B",s="VT"),(l=""===e[o]?null:(parseFloat(e[o])/10).toFixed(1))&&(a.push(l),n.push(s))}return t.setState({hours:n}),a},t.handlePrices=function(t){for(var e=[],a=0;a<t.length;a++){var n=null===t[a]?t[a]:t[a].toString();n=null===n?n:n.replace(".",","),e.push(n)}return e},t.MyResponsiveLine=function(e){console.log("chdata",e);var a=c.a.createElement(h.a,{data:e,margin:{top:50,right:5,bottom:50,left:35},xScale:{type:"point"},yScale:{type:"linear",min:0,max:"auto"},axisTop:null,axisRight:null,axisBottom:{tickSize:3,tickPadding:3,tickRotation:0,legend:"Spotpriser",legendOffset:35,legendPosition:"start"},axisLeft:{orient:"left",tickSize:3,tickPadding:3,tickRotation:0,legend:t.state.currency,legendOffset:-30,legendPosition:"end"},colors:{scheme:"set1"},pointSize:5,pointColor:{from:"color",modifiers:[]},pointBorderWidth:2,pointBorderColor:{from:"color"},pointLabel:"y",pointLabelYOffset:60,enableSlices:"x",legends:[{anchor:"top-left",direction:"row",justify:!1,translateX:10,translateY:-40,itemsSpacing:0,itemDirection:"left-to-right",itemWidth:80,itemHeight:20,itemOpacity:.75,symbolSize:10,symbolShape:"circle",symbolBorderColor:"rgba(0, 0, 0, .9)",effects:[{on:"hover",style:{itemBackground:"rgba(0, 0, 0, .08)",itemOpacity:1}}]}]});t.setState({chart:a})},t.state={pricenow:"0",currency:"\xf6re/kwh",hour:"0",name:"",average:"0",tempis:"0",measured:"0",should:"0",percent:"0",today:"",tomorrow:"",hours:[],prices:[],controls:[],tomspot:[],chart:null,chartdata:null,time:new Date},t}return Object(l.a)(e,t),Object(r.a)(e,[{key:"componentDidMount",value:function(){var t=this;console.log(window.location,this.props.location,this.props.location.pathname),this._isMounted=!0;var e=this.state.time,a=e.getHours(),n=e.getDate(),r=e.getDate()+1,o=e.getMonth()+1,s=n+"/"+o,l=r+"/"+o,i=e.getMinutes();console.log("52",a,i),fetch(y).then((function(t){return t.json()})).then((function(e){if(t._isMounted){var a=e.tempis.toFixed(1);return t.setState({should:e.should}),t.setState({measured:e.measured}),t.setState({tempis:a}),t.setState({name:e.name}),fetch(d)}})).then((function(t){return t.json()})).then((function(e){if(t._isMounted){var n="Hour"+a,r="EUR"===e.Currency?"c/kwh":"\xf6re/kwh",o=t.myformatter(e.Average),i=t.myformatter(e[n]),c=t.extractPrices(e),u=t.handlePrices(c),m=t.makeChartJson(c,"idag","hsl(12,100%,46%)");return t.setState({average:o}),t.setState({pricenow:i}),t.setState({hour:a}),t.setState({currency:r}),t.setState({today:s}),t.setState({tomorrow:l}),t.setState({prices:u}),t.setState({chartdata:m}),t.MyResponsiveLine([t.state.chartdata]),fetch(g)}})).then((function(t){return console.log("results2",t),t.json()})).then((function(e){return console.log("data2",e),t.setState({controls:e}),a>=16&&i>=3?fetch(f).then((function(t){return t.json()})).then((function(e){var a=t.extractPrices(e),n=t.handlePrices(a),r=t.state.chartdata,o=t.makeChartJson(a,"imorgon","orange"),s=[];return r&&s.push(r),o&&s.push(o),t.setState({tomspot:n}),t.MyResponsiveLine(s),fetch(b)})):fetch(b)})).then((function(t){return console.log(t),t.json()})).then((function(e){t.setState({percent:e.percent})})).catch((function(t){if(console.log(t),"AbortError"!==t.name)throw t})),setInterval(this.updateSec,1e3)}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"render",value:function(){var t=this.state.prices,e=this.state.controls,a=this.state.hours,n=this.state.percent,r=null,o=null,s=this.state.time,l=s.getHours(),i=s.getMinutes(),u=s.getSeconds();return this.state.hour>16&&(r=c.a.createElement("td",null,this.state.tomorrow),o=this.state.tomspot.map((function(t,e){return c.a.createElement("td",{key:e},t)}))),c.a.createElement("div",{className:"hub-page"},c.a.createElement("p",null,l,":",i<10?"0"+i:i,":",u<10?"0"+u:u," ",c.a.createElement("span",{className:"red-small larger-font"},this.state.pricenow," "),this.state.currency,c.a.createElement("br",null),"Medelpris ",c.a.createElement("span",{className:"red-small larger-font avg"},this.state.average)," ",c.a.createElement("span",{className:"currency"},this.state.currency),c.a.createElement("br",null),this.state.header,c.a.createElement("br",null),c.a.createElement("span",{className:"zonename"},this.state.name)," ",c.a.createElement("span",{className:"red-small larger-font hubtempis"},this.state.tempis)," \xb0C",c.a.createElement("br",null),"Du \xf6nskar ",c.a.createElement("span",{className:"red-small larger-font hubshould"},this.state.should)," \xb0C",c.a.createElement("br",null),"Uppm\xe4tt: ",this.state.measured),c.a.createElement(m.a,{striped:!0,bordered:!0,hover:!0,size:"sm",responsive:!0,className:"mytable"},c.a.createElement("thead",null,c.a.createElement("tr",null,a.map((function(t,e){return c.a.createElement("th",{key:e},t)})))),c.a.createElement("tbody",null,c.a.createElement("tr",null,c.a.createElement("td",null,this.state.today),t.map((function(t,e){return c.a.createElement("td",{key:e},t)}))),c.a.createElement("tr",{className:"control"},c.a.createElement("td",null,n+"%"),e.map((function(t,e){return c.a.createElement("td",{key:e,className:"class"+t})}))),c.a.createElement("tr",null,r,o))),c.a.createElement("div",{className:"chart"},this.state.chart))}}]),e}(i.Component)}}]);
//# sourceMappingURL=5.0fd2c176.chunk.js.map